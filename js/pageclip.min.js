!function(e){function s(){}var t={_base:a="string"==typeof __pageclip_base?__pageclip_base:"https://send.pageclip.co",_successTemplate:'<div class="pageclip-form__success__message">Message Sent, Thank You!</div>',cssBase:"pageclip-form",form:function(s,n){if(n=n||{},null==s)throw new Error("form() must be passed an HTMLFormElement or String, not null");if("string"==typeof s&&(s=document.querySelector(s)),!((s=e.jQuery&&s instanceof e.jQuery?s[0]:s)instanceof e.HTMLFormElement))throw new Error("form() must be passed an HTMLFormElement or String");var r=o(s.getAttribute("action")),a={"X-REQMETHOD":"form-v1","Content-Type":"application/json"},c=t.cssBase,u=t.cssBase+"--submitting",l=t.cssBase+"--error",d=t.cssBase+"--success",m=n.successTemplate||t._successTemplate,f=new i(s);s.classList.add(c),s.onsubmit=function(e){e.preventDefault(),f.start();e=JSON.stringify(t.formToJSON(s));var o=!1!==(!n.onSubmit||n.onSubmit());o&&(s.classList.add(u),t._showSubmitting(s),t._send(r.key,r.url,a,e,n,(function(e,r){o&&t._hideSubmitting(s),s.classList.remove(u),s.classList.add(e?l:d),!1===(!n.onResponse||n.onResponse(e,r))||e||t._showSuccess(s,m),e?console.error(e.message||e):s.reset(),setTimeout((function(){f.stop()}),200)})))}},send:function(e,s,n,r){s=t._base+"/"+e+"/"+(s||""),t._send(e,s,{"X-REQMETHOD":"send-v1","Content-Type":"application/json"},JSON.stringify(n),{},r)},formToJSON:function(e){for(var s=e.elements,t={},n=0;n<s.length;n++){var r=s[n];r.name.trim()&&("radio"!==r.type&&"checkbox"!==r.type||r.checked)&&(t[r.name]=r.value)}return t},_send:function(e,s,n,r,o,i){try{t._xhrFetch(e,s,n,r,i)}catch(s){t._sendError(e,s),i(s)}},_xhrFetch:function(n,r,o,i,a){var c,u=t._xhr();for(c in o=function(e,s){if(s)for(var t in s)e[t]=s[t];return e}({"X-REQTRANSPORT":"xhr","X-HASFETCH":!!e.fetch},o),a=a||s,u.onreadystatechange=function(){try{var e,s;4===u.readyState&&(e=u.response,s=200===u.status?null:new Error("Error submitting data: "+(e?e.error:"Unknown Error")),a(s,s?null:e))}catch(s){t._sendError(n,s),a(s)}},u.open("POST",r),u.responseType="json",o)u.setRequestHeader(c,o[c]);u.send(i)},_xhr:function(){return new(e.XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0")},_sendError:function(e,s){var n='{"error": "'+(s.stack||s.message||s+"").replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"}';(s=t._xhr()).open("POST",t._base+"/error/"+(e||"")),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("X-REQMETHOD","send-v1"),s.send(n)},_showSubmitting:function(e){n(e,!0)},_hideSubmitting:function(e){n(e,!1)},_showSuccess:function(e,s){var n=document.createElement("div");n.classList.add(t.cssBase+"__success"),n.innerHTML=s,n.onclick=function(){t._hideSuccess(e)},e.appendChild(n)},_hideSuccess:function(e){(e=e.querySelector("."+t.cssBase+"__success"))&&e.remove()}};function n(e,s){for(var t=e.querySelectorAll("input"),n=0;n<t.length;n++)t[n].disabled=s}var r=/^(.+)\/([\w\d]{32})(\/([^\/]*))?$/;function o(e){var s="Malformed action: "+e;if(!(e=r.exec(e)))throw new Error(s);if((e={base:e[1],key:e[2],bucket:e[4]||""}).base!==t._base||!e.key.length)throw new Error(s);return e.url=e.base+"/"+e.key+"/"+e.bucket,e}function i(e){this.el=e.querySelector("."+t.cssBase+"__submit")}var a="__submit--",c=t.cssBase+a+"start-loading",u=t.cssBase+a+"loading",l=t.cssBase+a+"end-loading";function d(e,s,t){var n=getComputedStyle(e,"::after");(e=n.animationName)&&"none"!==e?function(e,s){clearTimeout(m),e=1e3*parseFloat(e),m=setTimeout(s,e-10)}(n.animationDuration,s):t()}i.prototype.start=function(){var e;this.el&&(this.el.disabled=!0,(e=this.el.classList).remove(l),e.remove(u),e.add(c),d(this.el,(function(){e.remove(c),e.add(u)}),(function(){e.add(u),e.remove(c)})))},i.prototype.stop=function(){function e(){s.remove(l)}var s;this.el&&(this.el.disabled=!1,(s=this.el.classList).remove(c),s.remove(u),s.add(l),d(this.el,e,e))};var m=null;"undefined"!=typeof module&&void 0!==module.exports?(module.exports=t,module.exports.normalizeAction=o):(window.Pageclip=t,function(){for(var e=document.querySelectorAll("."+t.cssBase),s=0;s<e.length;s++)t.form(e[s])}())}(this||window||global);